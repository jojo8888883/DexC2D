# Sora视频要求和帧提取说明

## 视频规格要求

为了确保生成的视频符合项目要求，Sora自动化工具对视频有以下规格要求：

- **视频时长**: 5秒
- **帧率**: 30Hz (每秒30帧)
- **总帧数**: 150帧 (5秒 × 30帧/秒)
- **分辨率**: 480p
- **宽高比**: 3:2
- **帧命名格式**: frame_000000.png 到 frame_000149.png

## 视频处理流程

1. 通过Sora Web界面生成视频，设置时长为5秒
2. 下载生成的视频
3. 检查视频时长，如果不足5秒，通过复制最后一帧延长视频
4. 使用规则过滤器筛选符合条件的视频
5. 将通过过滤的视频转换为150帧PNG图像
6. 如果提取的帧少于150帧，使用最后一帧补足
7. 确保帧命名为frame_000000.png到frame_000149.png

## 视频过滤条件

符合以下条件的视频将被保留：

- **符合物理规律**: 视频中的运动遵循正常的物理规律
- **摄像机静止**: 背景不移动，只有前景物体和手有运动
- **物体无畸变**: 物体形状保持一致，没有非正常变形
- **只有手和物体有运动**: 其他场景元素保持静止

## 帧提取和命名

1. 从视频中提取帧时，会自动调整采样步长，确保输出30Hz的帧率
2. 无论原始视频帧率如何，最终都会得到exactly 150帧
3. 帧编号从0开始，命名为frame_000000.png, frame_000001.png, ... frame_000149.png
4. 如果视频提供的帧少于150帧，会复制最后一帧补足
5. 如果视频提供的帧多于150帧，只会保留前150帧

## 注意事项

- 生成的视频可能会略长于或短于5秒，系统会自动调整确保输出150帧
- 当多个视频通过过滤时，只会使用第一个满足条件的视频
- 过滤条件主要关注三方面：手部检测、目标物体检测和相机静止检测
- 每个视频会在输出目录中创建对应的filter.json文件，记录过滤结果详情

## 技术实现细节

- 使用Selenium自动控制Sora Web界面
- 使用OpenCV进行视频处理和帧提取
- 使用MediaPipe进行手部检测
- 使用YOLOv8进行物体检测
- 使用光流法(Optical Flow)检测相机是否静止

此自动化流程确保了输出视频帧的一致性和质量，满足项目对于5秒30Hz视频的要求。 